/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
author: hazelmatthews (https://sketchfab.com/hazelmatthews)
license: CC-BY-4.0 (http://creativecommons.org/licenses/by/4.0/)
source: https://sketchfab.com/3d-models/white-t-shirt-3f98e641831b41ccb1807d0f68cc51dc
title: White T-Shirt
*/

import * as THREE from 'three'
import {Color} from 'three'
import {useMemo} from 'react'
import {Decal, useGLTF, useTexture} from '@react-three/drei'
import {GLTF} from 'three-stdlib'

type GLTFResult = GLTF & {
    nodes: {
        mesh_0: THREE.Mesh
    }
    materials: {
        Default_OBJ: THREE.MeshStandardMaterial
    }
}

interface Props {
    color: string
    artworkUrl: string
}


export function Model(props: Props) {
    const decalTexture = useTexture(props.artworkUrl)
    // @ts-ignore
    const {nodes, materials} = useGLTF('/scene2.gltf') as GLTFResult
    const color = useMemo(() => {
        return new Color(props.color)
    }, [props.color]);

    return (
        <group dispose={null} position={[0, -2, 0]}>
            <mesh castShadow receiveShadow
                  geometry={nodes.mesh_0.geometry}
                  material={materials.Default_OBJ}
                  material-color={color}
                  scale={0.00005}
            >
                <Decal
                    // debug // Makes "bounding box" of the decal visible
                    position={[6700, 11500, 5000]} // Position of the decal
                    rotation={[0, 0, 0]} // Rotation of the decal (can be a vector or a degree in radians)
                    scale={5000} // Scale of the decal
                >

                    <meshStandardMaterial
                        polygonOffset
                        polygonOffsetFactor={-10}
                        transparent
                        map={decalTexture}
                    />
                </Decal>
            </mesh>
        </group>
    )
}

useGLTF.preload('/scene2.gltf')
